# 要求仕様書

## はじめに

ユビキタス言語システムは、ドメイン駆動設計（DDD）を実践するチームが、ユビキタス言語を効果的に管理・共有・進化させるための専用システムです。このシステムにより、ドメインの理解を深め、コミュニケーションの質を向上させ、より良いソフトウェア設計を実現します。

## 用語集

- **システム**: ユビキタス言語システム全体を指す
- **用語**: ユビキタス言語における用語（概念、エンティティ、値オブジェクトなど）
- **用語候補**: ユビキタス言語として採用を検討中の提案された用語
- **ユーザー**: システムを利用する開発者、ドメインエキスパート、プロダクトオーナーなど
- **境界づけられたコンテキスト**: DDDにおける境界づけられたコンテキスト
- **定義**: 用語の定義内容
- **検索クエリ**: ユーザーが入力する検索文字列
- **カバレッジ率**: ドメインの主要概念に対する登録済み用語の割合
- **アクティブユーザー**: 週に1回以上システムを利用するユーザー
- **議論スレッド**: 用語候補や既存用語について議論するためのコメントの集まり
- **見直しサイクル**: 用語の定義を定期的に確認し更新するプロセス

## 要求

### 要求 1: 用語の登録と管理

**ユーザーストーリー:** 開発者として、ドメイン用語を登録・編集・削除できるようにしたい。そうすることで、チーム全体で共通の用語定義を維持できる。

#### 受入基準

1. システムは、名前、定義、境界づけられたコンテキストを含む新しい用語を作成するためのユーザーインターフェースを提供しなければならない
2. ユーザーが用語作成リクエストを送信したとき、システムは指定された境界づけられたコンテキスト内で用語名が一意であることを検証しなければならない
3. システムは、ユーザーが既存の用語の定義を更新できるようにしなければならない
4. システムは、ユーザーが用語を削除できるようにしなければならない
5. 用語が削除されたとき、システムは完全に削除するのではなく、削除タイムスタンプとともに用語をアーカイブしなければならない

### 要求 2: 用語の検索と閲覧

**ユーザーストーリー:** ドメインエキスパートとして、必要な用語を素早く検索して定義を確認したい。そうすることで、開発チームとの会議中に即座に用語の意味を共有できる。

#### 受入基準

1. ユーザーが検索クエリを入力したとき、システムは名前または定義にクエリ文字列を含むすべての用語を2秒以内に返さなければならない
2. システムは、用語名、定義の簡単なプレビュー、関連する境界づけられたコンテキストを含む検索結果を表示しなければならない
3. ユーザーが検索結果から用語を選択したとき、システムはすべてのメタデータを含む完全な定義を表示しなければならない
4. システムは、各用語の閲覧回数を追跡しなければならない
5. システムは、ダッシュボードに最も頻繁に閲覧された用語を表示しなければならない

### 要求 3: 境界づけられたコンテキストの管理

**ユーザーストーリー:** アーキテクトとして、複数の境界づけられたコンテキストを定義し、各コンテキスト内で用語を管理したい。そうすることで、コンテキスト間での用語の使い分けを明確にできる。

#### 受入基準

1. システムは、ユーザーが名前と説明を持つ新しい境界づけられたコンテキストを作成できるようにしなければならない
2. 用語を作成するとき、システムはユーザーに用語が属する境界づけられたコンテキストを指定することを要求しなければならない
3. システムは、異なる境界づけられたコンテキストにおいて、同じ用語名が異なる定義で存在することを許可しなければならない
4. システムは、すべての境界づけられたコンテキストとそれに関連する用語を表示するビューを提供しなければならない
5. ユーザーが用語を閲覧したとき、システムはその用語がどの境界づけられたコンテキストに属しているかを表示しなければならない

### 要求 4: 用語の変更履歴追跡

**ユーザーストーリー:** プロジェクトマネージャーとして、用語の定義がどのように変更されてきたかを確認したい。そうすることで、ドメイン理解の進化を追跡し、変更の背景を理解できる。

#### 受入基準

1. ユーザーが用語の定義を更新したとき、システムは以前の定義、タイムスタンプ、ユーザー識別子を含む履歴レコードを作成しなければならない
2. システムは、各用語の完全な変更履歴を時系列順に表示しなければならない
3. システムは、ユーザーが用語の定義の任意の以前のバージョンを閲覧できるようにしなければならない
4. 履歴を表示するとき、システムは連続するバージョン間で何が変更されたかを表示しなければならない
5. システムは、すべての履歴レコードを無期限に保持しなければならない

### 要求 5: 新規メンバーのオンボーディング支援

**ユーザーストーリー:** 新規参加メンバーとして、プロジェクトの主要なドメイン用語を効率的に学習したい。そうすることで、早期にチームに貢献できるようになる。

#### 受入基準

1. システムは、新規メンバー向けの必須用語の厳選されたリストを提供しなければならない
2. システムは、ユーザーが用語を学習済みとしてマークできるようにしなければならない
3. ユーザーがオンボーディングダッシュボードを閲覧したとき、システムは学習済みとしてマークされた必須用語の割合として学習進捗を表示しなければならない
4. システムは、経験豊富なユーザーがオンボーディングに必須の用語を指定できるようにしなければならない
5. システムは、用語の依存関係に基づいた推奨学習順序を提供しなければならない

### 要求 6: コードとの連携

**ユーザーストーリー:** 開発者として、コード内のクラス名やメソッド名がユビキタス言語と一致しているか確認したい。そうすることで、コードとドメインモデルの整合性を保てる。

#### 受入基準

1. システムは、分析のためにアップロードされたソースコードファイルを受け入れなければならない
2. ソースコードがアップロードされたとき、システムはクラス名、メソッド名、変数名を抽出しなければならない
3. システムは、抽出された名前を登録済みの用語と比較し、一致率を計算しなければならない
4. システムは、どのコード要素が用語と一致し、どれが一致しないかを示すレポートを表示しなければならない
5. コード分析が有効な場合、システムは用語と一致するようにコード要素の名前を変更するための提案を提供しなければならない

### 要求 7: 用語間の関連性管理

**ユーザーストーリー:** モデラーとして、用語間の関係性（集約、関連、依存など）を定義したい。そうすることで、ドメインモデルの構造を可視化できる。

#### 受入基準

1. システムは、ユーザーが関係タイプと説明を持つ用語間の関係を定義できるようにしなければならない
2. システムは、集約、関連、依存、継承を含む関係タイプをサポートしなければならない
3. ユーザーが用語を閲覧したとき、システムは関係タイプとともにすべての関連用語を表示しなければならない
4. システムは、用語とその関係を示す視覚的な図を提供しなければならない
5. システムは、集約関係における循環依存を防止しなければならない

### 要求 8: 利用状況の測定

**ユーザーストーリー:** プロダクトオーナーとして、システムの利用状況とその効果を測定したい。そうすることで、投資対効果を評価し、改善点を特定できる。

#### 受入基準

1. システムは、週ごとのアクティブユーザー数を追跡しなければならない
2. システムは、登録済み用語のカバレッジ率を計算し表示しなければならない
3. システムは、各用語の検索頻度を追跡しなければならない
4. システムは、アクティブユーザー、カバレッジ率、最も検索された用語を含む主要な指標を表示するダッシュボードを提供しなければならない
5. システムは、外部分析のためにCSV形式で指標データをエクスポートできるようにしなければならない

### 要求 9: 用語定義の品質保証

**ユーザーストーリー:** ドメインエキスパートとして、用語の定義が明確で理解しやすいか確認したい。そうすることで、チーム全体が正確にドメインを理解できる。

#### 受入基準

1. ユーザーが用語を作成または更新したとき、システムは定義が少なくとも20文字を含むことを検証しなければならない
2. システムは、指定されたレビュアーが用語の定義を承認または変更を要求できるレビューワークフローを提供しなければならない
3. 用語がレビュー待ちのとき、システムはそれを下書きステータスとしてマークしなければならない
4. システムは、ユーザーが用語の定義に例と使用上の注意を追加できるようにしなければならない
5. システムは、定義の完全性、例、レビューステータスに基づいて各用語の品質スコアを表示しなければならない

### 要求 10: 用語の議論と承認プロセス

**ユーザーストーリー:** チームメンバーとして、新しい用語をユビキタス言語として採用するかどうかを議論し、その結果を記録したい。そうすることで、用語の採用理由と背景を明確にし、チーム全体の合意を形成できる。

#### 受入基準

1. システムは、ユーザーが用語候補を提案し、議論スレッドを開始できるようにしなければならない
2. ユーザーが議論スレッドにコメントを投稿したとき、システムはコメントをタイムスタンプとユーザー識別子とともに保存しなければならない
3. システムは、指定された承認者が用語候補を承認、却下、または保留にできるようにしなければならない
4. 用語候補が承認されたとき、システムは議論の履歴を保持したまま、その用語を正式な用語として登録しなければならない
5. システムは、各用語に対して定期的な見直しの期限を設定し、期限が近づいたときにユーザーに通知しなければならない

### 要求 11: 用語の見直しサイクル

**ユーザーストーリー:** ドメインエキスパートとして、既存の用語が現在のドメイン理解と一致しているか定期的に見直したい。そうすることで、ドメインの進化に合わせて用語を更新し、常に正確な定義を維持できる。

#### 受入基準

1. システムは、各用語に対して見直しサイクルの期間（例：3ヶ月、6ヶ月）を設定できるようにしなければならない
2. 用語の見直し期限が到来したとき、システムは担当者に通知を送信しなければならない
3. システムは、見直しプロセスにおいて、ユーザーが用語を「確認済み」「要更新」「要議論」のいずれかにマークできるようにしなければならない
4. ユーザーが用語を「要議論」としてマークしたとき、システムは自動的に議論スレッドを作成しなければならない
5. システムは、見直し履歴を記録し、いつ誰が見直しを行ったかを表示しなければならない

### 要求 12: AI統合による用語分析と支援

**ユーザーストーリー:** チームメンバーとして、AIを活用して用語の明確さを分析し、用語決定の相談役として利用したい。そうすることで、より適切で明確な用語定義を作成でき、既存のユビキタス言語との整合性を保てる。

#### 受入基準

1. ユーザーが用語の定義を入力したとき、システムはAIを使用して定義の明確さ、曖昧さ、改善提案を分析しなければならない
2. システムは、既存のすべての用語と定義をAIのコンテキストとして提供し、新しい用語候補が既存の用語体系と整合しているかを評価しなければならない
3. ユーザーが用語に関する質問をしたとき、システムはAIが既存のユビキタス言語の知識に基づいて回答を提供できるようにしなければならない
4. システムは、AIが提案する類似用語や関連用語を表示し、用語の重複や不整合を防止しなければならない
5. システムは、AIによる分析結果と提案を、ユーザーが承認または却下できる形で提示しなければならない

### 要求 13: エクスポートとバックアップ

**ユーザーストーリー:** システム管理者として、すべての用語データをエクスポートできるようにしたい。そうすることで、データの損失を防ぎ、他のツールとの連携も可能になる。

#### 受入基準

1. システムは、すべての用語、定義、メタデータを含むJSONファイルを生成するエクスポート機能を提供しなければならない
2. システムは、境界づけられたコンテキストごとに整理されたすべての用語を含むMarkdownドキュメントを生成するエクスポート機能を提供しなければならない
3. ユーザーがエクスポートを要求したとき、システムは最大1000用語に対して10秒以内にエクスポートを完了しなければならない
4. システムは、以前にエクスポートされたJSONファイルから用語をインポートできるようにしなければならない
5. インポート時、システムは変更を適用する前にデータ形式を検証し、エラーを報告しなければならない
