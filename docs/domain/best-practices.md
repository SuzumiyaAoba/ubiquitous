# ユビキタス言語のベストプラクティス

## 言語の構築方法

### 1. ドメインワークショップの開催

開発者、ドメインエキスパート、ステークホルダーが協力して用語を定義・洗練するセッションを定期的に開催します。

**実施方法:**
- ドメインエキスパートが自然にプロセスや問題を説明する際の言葉に注意深く耳を傾ける
- イベントストーミングなどの手法を活用して、ビジネスドメインに関連する概念を抽出
- 全員で用語の定義を議論し、合意形成を行う

### 2. 継続的な改善

ユビキタス言語は一度作って終わりではなく、常に進化させる必要があります。

**実践ポイント:**
- 定期的なレビューと更新
- ドメインエキスパートとの会話で言語をテストする
- チームのドメイン理解が深まるにつれて言語（およびモデル）を進化させる
- 新しい洞察や要件変更に応じて用語を追加・修正

### 3. あらゆる場所での使用

ユビキタス言語は、その名の通り「あらゆる場所」で使用します。

**適用範囲:**
- コード（クラス名、メソッド名、変数名）
- ドキュメント（仕様書、設計書、API文書）
- 会話（ミーティング、レビュー、質疑応答）
- テストコード（テストケース名、アサーション）
- コミットメッセージ

### 4. すべてを文書化

生きた用語集（Living Glossary）を維持します。

**文書化のアプローチ:**
- 用語とその定義を一元管理
- 使用例やコンテキストを記載
- 変更履歴の追跡
- アクセスしやすい場所に配置

## ネーミング規約

### コアドメインでの命名

**イタチ言葉（Weasel Words）の排除:**
- コアドメインのクラス名からイタチ言葉を完全に削除する
- ユビキタス言語に属さないクラス名にのみイタチ言葉の使用を許可

**イタチ言葉の例:**
- `Manager`
- `Helper`
- `Utility`
- `Service`（ドメインサービスでない場合）

### ビジネスドメインとの一致

ソフトウェアコードの構造と言語（クラス名、メソッド、変数）は、ビジネスドメインと一致させます。

**例: 融資申請処理システム**
```
クラス: LoanApplication, Customer
メソッド: acceptOffer(), withdraw()
```

これにより、技術者・非技術者の両方がコードを理解できるようになります。

## 実装パターン

### 1. ドメインモデルへの反映

```typescript
// 悪い例 - 技術的な用語
class DataProcessor {
  process(input: any): any { }
}

// 良い例 - ユビキタス言語を使用
class RebateCalculator {
  calculatePerformance(productGroup: ProductGroup): Rebate { }
}
```

### 2. メソッド名での表現

```typescript
// 悪い例 - 曖昧な動詞
updateStatus()

// 良い例 - ビジネス用語を使用
approveApplication()
rejectApplication()
withdrawApplication()
```

### 3. 値オブジェクトでの概念表現

```typescript
// ドメインの概念を明示的に表現
class DrugClass {
  constructor(
    private readonly productGroups: ProductGroup[],
    private readonly competitiveMarket: string
  ) {}
}

class ProductGroup {
  constructor(
    private readonly manufacturer: Manufacturer,
    private readonly products: Product[]
  ) {}
}
```

## チーム開発での実践

### 定期的なミーティング

開発チーム、プロジェクトマネージャー、運用スタッフ間でユビキタス言語について議論する定期ミーティングを設定します。

**議題例:**
- 新規用語の提案と承認
- 既存用語の見直し
- 用語の使用状況の確認
- 曖昧さや矛盾の解消

### コードレビューでの確認

コードレビュー時に、ユビキタス言語が適切に使用されているかを確認します。

**チェックポイント:**
- 命名がユビキタス言語に準拠しているか
- ドメインエキスパートが理解できる表現か
- 技術的な用語が不必要に混入していないか

## よくある落とし穴と対策

### 落とし穴1: 技術者だけで言語を決める
**対策:** 必ずドメインエキスパートを巻き込む

### 落とし穴2: 一度決めたら変えない
**対策:** 継続的な見直しと進化を前提とする

### 落とし穴3: ドキュメントだけに記載してコードに反映しない
**対策:** コードファーストで実装し、コードとドキュメントの同期を保つ

### 落とし穴4: 曖昧な用語を残す
**対策:** 曖昧さが見つかった時点で即座に明確化する

### 落とし穴5: コンテキストの境界を意識しない
**対策:** 境界づけられたコンテキストを明確にし、コンテキストごとに用語を定義する
